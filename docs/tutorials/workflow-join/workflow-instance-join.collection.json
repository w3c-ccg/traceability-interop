{
	"info": {
		"_postman_id": "c0814470-0c07-43ad-9ed4-2ad4b125c937",
		"name": "Workflow Instance Join",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Get Access Token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Importer application has access token\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"`org_1_access_token` persisted to collectionVariables\", function() {",
							"    const { access_token } = pm.response.json()",
							"    pm.collectionVariables.set(\"org_1_access_token\", access_token);",
							"});",
							"",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "audience",
							"value": "{{ORG_1_TOKEN_AUDIENCE}}",
							"type": "text"
						},
						{
							"key": "client_id",
							"value": "{{ORG_1_CLIENT_ID}}",
							"type": "text"
						},
						{
							"key": "client_secret",
							"value": "{{ORG_1_CLIENT_SECRET}}",
							"type": "text"
						},
						{
							"key": "grant_type",
							"value": "client_credentials",
							"type": "text"
						},
						{
							"key": "scope",
							"value": "resolve:dids issue:credentials prove:presentations verify:presentations",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{ORG_1_TOKEN_ENDPOINT}}",
					"host": [
						"{{ORG_1_TOKEN_ENDPOINT}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get Access Token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Importer application has access token\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"`org_2_access_token` persisted to collectionVariables\", function() {",
							"    const { access_token } = pm.response.json()",
							"    pm.collectionVariables.set(\"org_2_access_token\", access_token);",
							"});",
							"",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "audience",
							"value": "{{ORG_2_TOKEN_AUDIENCE}}",
							"type": "text"
						},
						{
							"key": "client_id",
							"value": "{{ORG_2_CLIENT_ID}}",
							"type": "text"
						},
						{
							"key": "client_secret",
							"value": "{{ORG_2_CLIENT_SECRET}}",
							"type": "text"
						},
						{
							"key": "grant_type",
							"value": "client_credentials",
							"type": "text"
						},
						{
							"key": "scope",
							"value": "resolve:dids issue:credentials prove:presentations verify:presentations",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{ORG_2_TOKEN_ENDPOINT}}",
					"host": [
						"{{ORG_2_TOKEN_ENDPOINT}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get Access Token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Importer application has access token\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"`org_3_access_token` persisted to collectionVariables\", function() {",
							"    const { access_token } = pm.response.json()",
							"    pm.collectionVariables.set(\"org_3_access_token\", access_token);",
							"});",
							"",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "audience",
							"value": "{{ORG_3_TOKEN_AUDIENCE}}",
							"type": "text"
						},
						{
							"key": "client_id",
							"value": "{{ORG_3_CLIENT_ID}}",
							"type": "text"
						},
						{
							"key": "client_secret",
							"value": "{{ORG_3_CLIENT_SECRET}}",
							"type": "text"
						},
						{
							"key": "grant_type",
							"value": "client_credentials",
							"type": "text"
						},
						{
							"key": "scope",
							"value": "resolve:dids issue:credentials prove:presentations verify:presentations",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{ORG_3_TOKEN_ENDPOINT}}",
					"host": [
						"{{ORG_3_TOKEN_ENDPOINT}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get Organization DIDs",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const { didDocument } = pm.response.json()",
							"pm.collectionVariables.set(\"org_1_holder\", didDocument.id);",
							"pm.collectionVariables.set(\"org_1_tenant_url\", didDocument.service[0].serviceEndpoint);",
							"",
							"pm.test(\"Importer has holder DID\", function () {",
							"     pm.expect(pm.collectionVariables.get(\"org_1_holder\")).to.not.be.undefined;",
							"});",
							"",
							"pm.test(\"Importer has service endpoint\", function () {",
							"     pm.expect(pm.collectionVariables.get(\"org_1_tenant_url\")).to.not.be.undefined;",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{org_1_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"url": {
					"raw": "{{ORG_1_BASE_URL}}/identifiers/{{ORG_1_DID_WEB}}",
					"host": [
						"{{ORG_1_BASE_URL}}"
					],
					"path": [
						"identifiers",
						"{{ORG_1_DID_WEB}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get Organization DIDs",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const { didDocument } = pm.response.json()",
							"pm.collectionVariables.set(\"org_2_holder\", didDocument.id);",
							"pm.collectionVariables.set(\"org_2_tenant_url\", didDocument.service[0].serviceEndpoint);",
							"",
							"pm.test(\"Freight Forwarder has holder DID\", function () {",
							"     pm.expect(pm.collectionVariables.get(\"org_2_holder\")).to.not.be.undefined;",
							"});",
							"",
							"pm.test(\"Freight Forwarder has service endpoint\", function () {",
							"     pm.expect(pm.collectionVariables.get(\"org_2_tenant_url\")).to.not.be.undefined;",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{org_2_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"url": {
					"raw": "{{ORG_2_BASE_URL}}/identifiers/{{ORG_2_DID_WEB}}",
					"host": [
						"{{ORG_2_BASE_URL}}"
					],
					"path": [
						"identifiers",
						"{{ORG_2_DID_WEB}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get Organization DIDs",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const { didDocument } = pm.response.json()",
							"pm.collectionVariables.set(\"org_3_holder\", didDocument.id);",
							"pm.collectionVariables.set(\"org_3_tenant_url\", didDocument.service[0].serviceEndpoint);",
							"",
							"pm.test(\"Customs has holder DID\", function () {",
							"     pm.expect(pm.collectionVariables.get(\"org_3_holder\")).to.not.be.undefined;",
							"});",
							"",
							"pm.test(\"Customs has service endpoint\", function () {",
							"     pm.expect(pm.collectionVariables.get(\"org_3_tenant_url\")).to.not.be.undefined;",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{org_3_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"url": {
					"raw": "{{ORG_3_BASE_URL}}/identifiers/{{ORG_3_DID_WEB}}",
					"host": [
						"{{ORG_3_BASE_URL}}"
					],
					"path": [
						"identifiers",
						"{{ORG_3_DID_WEB}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Issue Credential",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"  pm.test(\"Proforma Invoice VC issued\", function () {",
							"      pm.response.to.have.status(201);",
							"      const {verifiableCredential} = pm.response.json();",
							"      pm.collectionVariables.set('importers_proforma_invoice_vc', JSON.stringify(verifiableCredential));",
							"  });"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{org_1_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"credential\": {\n        \"@context\": [\n            \"https://www.w3.org/2018/credentials/v1\",\n            \"https://w3id.org/traceability/v1\"\n        ],\n        \"type\": [\n            \"VerifiableCredential\",\n            \"CommercialInvoiceCertificate\"\n        ],\n        \"name\": \"Commercial Invoice Certificate\",\n        \"issuanceDate\": \"2022-02-23T11:55:00Z\",\n        \"issuer\": {\n            \"id\": \"{{org_1_holder}}\",\n            \"type\": [\n                \"Organization\"\n            ],\n            \"address\": {\n                \"type\": [\n                    \"PostalAddress\"\n                ],\n                \"organizationName\": \"Aishi Metal Shinzo Co., Ltd.\",\n                \"streetAddress\": \"1651, Shimonakano, Yoshida\",\n                \"addressLocality\": \"Tsubame-shi\",\n                \"addressRegion\": \"Niigata-ken\",\n                \"postalCode\": \"959-0215\",\n                \"addressCountry\": \"Japan\"\n            }\n        },\n        \"credentialSubject\": {\n            \"type\": [\n                \"Invoice\"\n            ],\n            \"portOfEntry\": {\n                \"type\": \"Place\",\n                \"unLocode\": \"USLGB\"\n            },\n            \"destinationCountry\": \"MEX\",\n            \"purchaseDate\": \"2021-02-21\",\n            \"seller\": {\n                \"type\": [\n                    \"Organization\"\n                ],\n                \"address\": {\n                    \"type\": [\n                        \"PostalAddress\"\n                    ],\n                    \"organizationName\": \"Aishi Metal Shinzo Co., Ltd.\",\n                    \"streetAddress\": \"1651, Shimonakano, Yoshida\",\n                    \"addressLocality\": \"Tsubame-shi\",\n                    \"addressRegion\": \"Niigata-ken\",\n                    \"postalCode\": \"959-0215\",\n                    \"addressCountry\": \"Japan\"\n                }\n            },\n            \"buyer\": {\n                \"type\": [\n                    \"Organization\"\n                ],\n                \"address\": {\n                    \"type\": [\n                        \"PostalAddress\"\n                    ],\n                    \"organizationName\": \"Generic Motors of America\",\n                    \"streetAddress\": \"12 Generic Motors Dr\",\n                    \"addressLocality\": \"Detroit\",\n                    \"addressRegion\": \"Michigain\",\n                    \"postalCode\": \"48232-5170\",\n                    \"addressCountry\": \"USA\"\n                }\n            },\n            \"shipToParty\": {\n                \"type\": [\n                    \"Organization\"\n                ],\n                \"address\": {\n                    \"type\": [\n                        \"PostalAddress\"\n                    ],\n                    \"organizationName\": \"Generic Motors of America\",\n                    \"streetAddress\": \"12 Generic Motors Dr\",\n                    \"addressLocality\": \"Detroit\",\n                    \"addressRegion\": \"Michigain\",\n                    \"postalCode\": \"48232-5170\",\n                    \"addressCountry\": \"USA\"\n                }\n            },\n            \"itemsShipped\": [\n                {\n                    \"type\": \"TradeLineItem\",\n                    \"product\": {\n                        \"manufacturer\": {\n                            \"type\": \"Organization\",\n                            \"address\": {\n                                \"type\": \"PostalAddress\",\n                                \"organizationName\": \"Aishi Metal Shinzo Co., Ltd.\",\n                                \"streetAddress\": \"1651, Shimonakano, Yoshida\",\n                                \"addressLocality\": \"Tsubame-shi\",\n                                \"addressRegion\": \"Niigata-ken\",\n                                \"postalCode\": \"959-0215\",\n                                \"addressCountry\": \"Japan\"\n                            }\n                        },\n                        \"description\": \"UNS S30400 chromium-nickel stainless steel rolls.\",\n                        \"weight\": {\n                            \"type\": \"QuantitativeValue\",\n                            \"unitCode\": \"lbs\",\n                            \"value\": \"16500\"\n                        }\n                    },\n                    \"itemCount\": 5,\n                    \"tradeLineItemWeight\": {\n                        \"type\": \"QuantitativeValue\",\n                        \"value\": \"82500\",\n                        \"unitCode\": \"lbs\"\n                    },\n                    \"priceSpecification\": {\n                        \"type\": \"PriceSpecification\",\n                        \"price\": 5200,\n                        \"priceCurrency\": \"USD\"\n                    }\n                },\n                {\n                    \"type\": \"TradeLineItem\",\n                    \"product\": {\n                        \"manufacturer\": {\n                            \"type\": \"Organization\",\n                            \"address\": {\n                                \"type\": \"PostalAddress\",\n                                \"organizationName\": \"Aishi Metal Shinzo Co., Ltd.\",\n                                \"streetAddress\": \"1651, Shimonakano, Yoshida\",\n                                \"addressLocality\": \"Tsubame-shi\",\n                                \"addressRegion\": \"Niigata-ken\",\n                                \"postalCode\": \"959-0215\",\n                                \"addressCountry\": \"Japan\"\n                            }\n                        },\n                        \"description\": \"Galvalannealed ASTM A-653 zinc-iron alloy-coated steel sheets.\",\n                        \"weight\": {\n                            \"type\": \"QuantitativeValue\",\n                            \"value\": \"12680\",\n                            \"unitCode\": \"lbs\"\n                        }\n                    },\n                    \"itemCount\": 20,\n                    \"tradeLineItemWeight\": {\n                        \"type\": \"QuantitativeValue\",\n                        \"value\": \"253600\",\n                        \"unitCode\": \"lbs\"\n                    },\n                    \"priceSpecification\": {\n                        \"type\": \"PriceSpecification\",\n                        \"price\": 4400,\n                        \"priceCurrency\": \"USD\"\n                    }\n                }\n            ],\n            \"totalWeight\": {\n                \"type\": \"QuantitativeValue\",\n                \"value\": \"336100\",\n                \"unitCode\": \"lbs\"\n            },\n            \"totalPaymentDue\": {\n                \"type\": \"PriceSpecification\",\n                \"price\": 9600,\n                \"priceCurrency\": \"USD\"\n            }\n        }\n    },\n    \"options\": {\n        \"type\": \"Ed25519Signature2018\"\n    }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{ORG_1_BASE_URL}}/credentials/issue",
					"host": [
						"{{ORG_1_BASE_URL}}"
					],
					"path": [
						"credentials",
						"issue"
					]
				}
			},
			"response": []
		},
		{
			"name": "Initiate Exchange",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const responseJson = pm.response.json();",
							"pm.collectionVariables.set(\"org_3_domain\", responseJson.domain);",
							"pm.collectionVariables.set(\"org_3_challenge\", responseJson.challenge);",
							"",
							"pm.test(\"Importer has authenticated to Customs\", function () {",
							"    pm.response.to.have.status(200);",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"query\": [\n    {\n      \"type\": \"QueryByExample\",\n      \"credentialQuery\": [\n        {\n          \"type\": [\n            \"VerifiableCredential\"\n          ],\n          \"reason\": \"We want to present credentials.\"\n        }\n      ]\n    }\n  ]\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{org_3_tenant_url}}/presentations/available",
					"host": [
						"{{org_3_tenant_url}}"
					],
					"path": [
						"presentations",
						"available"
					]
				}
			},
			"response": []
		},
		{
			"name": "Sign Presentation",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const {verifiablePresentation} = pm.response.json();",
							"pm.collectionVariables.set(\"importers_proforma_invoice_presented_to_customs\", JSON.stringify(verifiablePresentation));",
							"",
							"pm.test(\"Importer VP of Proforma Invoice with workflow instance 'instance_1' proved\", function () {",
							"    pm.response.to.have.status(201);",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{org_1_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"presentation\": {\n        \"@context\": [\n            \"https://www.w3.org/2018/credentials/v1\",\n            \"https://w3id.org/traceability/v1\"\n        ],\n        \"type\": [\n            \"VerifiablePresentation\",\n            \"TraceablePresentation\"\n        ],\n        \"workflow\": {\n            \"instance\": [\n                \"instance_1\"\n            ],\n            \"definition\": [\n                \"definition_1\"\n            ]\n        },\n        \"holder\": \"{{org_1_holder}}\",\n        \"verifiableCredential\": [\n            {{importers_proforma_invoice_vc}}\n        ]\n    },\n    \"options\": {\n        \"domain\": \"{{org_3_domain}}\",\n        \"challenge\": \"{{org_3_challenge}}\"\n    }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{ORG_1_BASE_URL}}/presentations/prove",
					"host": [
						"{{ORG_1_BASE_URL}}"
					],
					"path": [
						"presentations",
						"prove"
					]
				}
			},
			"response": []
		},
		{
			"name": "Complete Exchange",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"",
							"// The expected response code for a \"Verify Presentation\" request is",
							"// `200 Success`.",
							"pm.test(\"Importer has successfully presented Proforma Invoice to Customs\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"// Response should confirm the presentation is verified.",
							"pm.test(\"Proforma Invoice VP verification returned 'true'\", function() {",
							"    const { verified } = pm.response.json()",
							"    pm.expect(verified).to.be.true;",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{{importers_proforma_invoice_presented_to_customs}}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{org_3_tenant_url}}/presentations/submissions",
					"host": [
						"{{org_3_tenant_url}}"
					],
					"path": [
						"presentations",
						"submissions"
					]
				}
			},
			"response": []
		},
		{
			"name": "Verify Credential",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Customs verifies Proforma Invoice\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"var workflowInstances = JSON.parse(pm.collectionVariables.get(\"importers_proforma_invoice_presented_to_customs\")).workflow.instance",
							"",
							"pm.test(\"Customs stores first workflow instance id: \" + workflowInstances[0], function () {",
							"    pm.collectionVariables.set(\"customs_first_workflow_instance_id\", workflowInstances[0]);",
							"});",
							"",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{org_3_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"verifiablePresentation\": {{importers_proforma_invoice_presented_to_customs}},\n    \"options\": {\n        \"domain\": \"{{org_3_domain}}\",\n        \"challenge\": \"{{org_3_challenge}}\"\n    }\n}\n",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{ORG_3_BASE_URL}}/presentations/verify",
					"host": [
						"{{ORG_3_BASE_URL}}"
					],
					"path": [
						"presentations",
						"verify"
					]
				}
			},
			"response": []
		},
		{
			"name": "Issue Credential",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"  pm.test(\"House Bill of Lading VC issued\", function () {",
							"      pm.response.to.have.status(201);",
							"      const {verifiableCredential} = pm.response.json();",
							"      pm.collectionVariables.set('freight_forwarders_hbol_vc', JSON.stringify(verifiableCredential));",
							"  });"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{org_2_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"credential\": {\n        \"@context\": [\n            \"https://www.w3.org/2018/credentials/v1\",\n            \"https://w3id.org/traceability/v1\"\n        ],\n        \"id\": \"did:key:z6MkmbqKc6KncFZUbVJwUppttTkiMAtnVJ5wzC5oVBWci3pc\",\n        \"type\": [\n            \"VerifiableCredential\",\n            \"HouseBillOfLadingCertificate\"\n        ],\n        \"name\": \"House Bill Of Lading\",\n        \"issuanceDate\": \"2022-03-04T13:40:00Z\",\n        \"issuer\": {\n            \"type\": \"Organization\",\n            \"id\": \"{{org_2_holder}}\",\n            \"name\": \"World Forward, Inc.\",\n            \"address\": {\n                \"type\": \"PostalAddress\",\n                \"organizationName\": \"MCL Multi Container Line LTD.\",\n                \"streetAddress\": \"Well Fung Ind Centre\",\n                \"addressLocality\": \"Kwai Chung\",\n                \"addressRegion\": \"Hong Kong\",\n                \"addressCountry\": \"Hong Kong\"\n            }\n        },\n        \"credentialSubject\": {\n            \"type\": \"HouseBillOfLading\",\n            \"billOfLadingNumber\": \"FF873363210A\",\n            \"bookingNumber\": [\n                \"FF873363210\"\n            ],\n            \"shipper\": {\n                \"type\": \"Organization\",\n                \"name\": \"Espresso Italiano Co.\",\n                \"address\": {\n                    \"type\": \"PostalAddress\",\n                    \"streetAddress\": \"Via Vico Ferrovia 5\",\n                    \"addressLocality\": \"Goro\",\n                    \"addressRegion\": \"Ferrara\",\n                    \"postalCode\": \"44020\",\n                    \"addressCountry\": \"IT\"\n                },\n                \"email\": \"sales@espresso-italiano.example.com\",\n                \"phoneNumber\": \"+39 0351 9067195\"\n            },\n            \"consignee\": {\n                \"type\": \"Organization\",\n                \"name\": \"Prosumer Coffee Supplies, Ltd.\",\n                \"description\": \"Coffee Machine Imports\",\n                \"address\": {\n                    \"type\": \"PostalAddress\",\n                    \"streetAddress\": \"3934 Spinnaker Lane\",\n                    \"addressLocality\": \"Joliet\",\n                    \"addressRegion\": \"Illinois\",\n                    \"postalCode\": \"60432\",\n                    \"addressCountry\": \"US\"\n                }\n            },\n            \"notifyParty\": [\n                {\n                    \"type\": \"Organization\",\n                    \"name\": \"Prosumer Coffee Supplies, Ltd.\",\n                    \"description\": \"Coffee Machine Imports\",\n                    \"address\": {\n                        \"type\": \"PostalAddress\",\n                        \"streetAddress\": \"3934 Spinnaker Lane\",\n                        \"addressLocality\": \"Joliet\",\n                        \"addressRegion\": \"Illinois\",\n                        \"postalCode\": \"60432\",\n                        \"addressCountry\": \"US\"\n                    }\n                }\n            ],\n            \"carrier\": {\n                \"type\": \"Organization\",\n                \"id\": \"did:key:z6MktHQo3fRRohk44dsbE76CuiTpBmyMWq2VVjvV6aBSeE3U\",\n                \"name\": \"World Forward, Inc.\",\n                \"address\": {\n                    \"type\": \"PostalAddress\",\n                    \"organizationName\": \"MCL Multi Container Line LTD.\",\n                    \"streetAddress\": \"Well Fung Ind Centre\",\n                    \"addressLocality\": \"Kwai Chung\",\n                    \"addressRegion\": \"Hong Kong\",\n                    \"addressCountry\": \"Hong Kong\"\n                }\n            },\n            \"mainCarriageTransportMovement\": {\n                \"type\": \"Transport\",\n                \"vesselNumber\": \"MS Seven Seas\",\n                \"voyageNumber\": \"Atl-W0425\"\n            },\n            \"portOfLoading\": {\n                \"type\": \"Place\",\n                \"unLocode\": \"ITMIL\"\n            },\n            \"portOfDischarge\": {\n                \"type\": \"Place\",\n                \"unLocode\": \"USLGB\"\n            },\n            \"totalNumberOfPackages\": 2200,\n            \"transportEquipmentQuantity\": 2,\n            \"includedConsignmentItems\": [\n                {\n                    \"marksAndNumbers\": \"Espresso Italiano\",\n                    \"commodity\": {\n                        \"type\": \"Commodity\",\n                        \"commodityCode\": \"851671\",\n                        \"commodityCodeType\": \"HS\"\n                    },\n                    \"packageQuantity\": 220,\n                    \"netWeight\": {\n                        \"type\": \"QuantitativeValue\",\n                        \"unitCode\": \"kg\",\n                        \"value\": \"1460\"\n                    },\n                    \"grossWeight\": {\n                        \"type\": \"QuantitativeValue\",\n                        \"unitCode\": \"kg\",\n                        \"value\": \"1590\"\n                    },\n                    \"grossVolume\": {\n                        \"type\": \"QuantitativeValue\",\n                        \"value\": \"85\",\n                        \"unitCode\": \"cmb\"\n                    }\n                }\n            ],\n            \"freightAndCharges\": {\n                \"type\": \"ServiceCharge\",\n                \"chargeCode\": \"basicFreight\",\n                \"paymentTerm\": \"collect\",\n                \"chargeText\": \"Negotiated ocean freight\",\n                \"rate\": {\n                    \"type\": \"PriceSpecification\",\n                    \"price\": 225,\n                    \"priceCurrency\": \"USD\"\n                },\n                \"calculationBasis\": \"Per container\",\n                \"appliedAmount\": {\n                    \"type\": \"PriceSpecification\",\n                    \"price\": 450,\n                    \"priceCurrency\": \"USD\"\n                }\n            },\n            \"declaredValue\": {\n                \"type\": \"PriceSpecification\",\n                \"price\": 24000,\n                \"priceCurrency\": \"USD\"\n            },\n            \"termsAndConditions\": \"https://terms-of-shipment.freightforwarder.example.com\"\n        }\n    },\n    \"options\": {\n        \"type\": \"Ed25519Signature2018\"\n    }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{ORG_2_BASE_URL}}/credentials/issue",
					"host": [
						"{{ORG_2_BASE_URL}}"
					],
					"path": [
						"credentials",
						"issue"
					]
				}
			},
			"response": []
		},
		{
			"name": "Initiate Exchange",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const responseJson = pm.response.json();",
							"pm.collectionVariables.set(\"org_3_domain\", responseJson.domain);",
							"pm.collectionVariables.set(\"org_3_challenge\", responseJson.challenge);",
							"",
							"pm.test(\"Freight Forwarder has authenticated to Customs\", function () {",
							"    pm.response.to.have.status(200);",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"query\": [\n    {\n      \"type\": \"QueryByExample\",\n      \"credentialQuery\": [\n        {\n          \"type\": [\n            \"VerifiableCredential\"\n          ],\n          \"reason\": \"We want to present credentials.\"\n        }\n      ]\n    }\n  ]\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{org_3_tenant_url}}/presentations/available",
					"host": [
						"{{org_3_tenant_url}}"
					],
					"path": [
						"presentations",
						"available"
					]
				}
			},
			"response": []
		},
		{
			"name": "Sign Presentation",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const {verifiablePresentation} = pm.response.json();",
							"pm.collectionVariables.set(\"freight_forwarders_house_bill_presented_to_customs\", JSON.stringify(verifiablePresentation));",
							"",
							"pm.test(\"Freight Forwarder VP of House Bill of Lading with workflow instance 'instance_2' proved\", function () {",
							"    pm.response.to.have.status(201);",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{org_2_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"presentation\": {\n        \"@context\": [\n            \"https://www.w3.org/2018/credentials/v1\",\n            \"https://w3id.org/traceability/v1\"\n        ],\n        \"type\": [\n            \"VerifiablePresentation\",\n            \"TraceablePresentation\"\n        ],\n        \"workflow\": {\n            \"instance\": [\n                \"instance_2\"\n            ],\n            \"definition\": [\n                \"definition_1\"\n            ]\n        },\n        \"holder\": \"{{org_2_holder}}\",\n        \"verifiableCredential\": [\n            {{freight_forwarders_hbol_vc}}\n        ]\n    },\n    \"options\": {\n        \"domain\": \"{{org_3_domain}}\",\n        \"challenge\": \"{{org_3_challenge}}\"\n    }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{ORG_2_BASE_URL}}/presentations/prove",
					"host": [
						"{{ORG_2_BASE_URL}}"
					],
					"path": [
						"presentations",
						"prove"
					]
				}
			},
			"response": []
		},
		{
			"name": "Complete Exchange",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"",
							"// The expected response code for a \"Verify Presentation\" request is",
							"// `200 Success`.",
							"pm.test(\"Freight Forwarder has successfully presented House Bill of Lading to Customs\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"// Response should confirm the presentation is verified.",
							"pm.test(\"House Bill of Lading VP verification returned 'true'\", function() {",
							"    const { verified } = pm.response.json()",
							"    pm.expect(verified).to.be.true;",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{{freight_forwarders_house_bill_presented_to_customs}}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{org_3_tenant_url}}/presentations/submissions",
					"host": [
						"{{org_3_tenant_url}}"
					],
					"path": [
						"presentations",
						"submissions"
					]
				}
			},
			"response": []
		},
		{
			"name": "Verify Credential",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Customs verifies House Bill of Lading\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"var workflowInstances = JSON.parse(pm.collectionVariables.get(\"freight_forwarders_house_bill_presented_to_customs\")).workflow.instance",
							"",
							"pm.test(\"Customs stores first workflow instance id: \" + workflowInstances[0], function () {",
							"    pm.collectionVariables.set(\"customs_second_workflow_instance_id\", workflowInstances[0]);",
							"});",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{org_3_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"verifiablePresentation\": {{freight_forwarders_house_bill_presented_to_customs}},\n    \"options\": {\n        \"domain\": \"{{org_3_domain}}\",\n        \"challenge\": \"{{org_3_challenge}}\"\n    }\n}\n",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{ORG_3_BASE_URL}}/presentations/verify",
					"host": [
						"{{ORG_3_BASE_URL}}"
					],
					"path": [
						"presentations",
						"verify"
					]
				}
			},
			"response": []
		},
		{
			"name": "Issue Credential",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"  pm.test(\"Commercial Invoice VC issued\", function () {",
							"      pm.response.to.have.status(201);",
							"      const {verifiableCredential} = pm.response.json();",
							"      pm.collectionVariables.set('importers_commercial_invoice_vc', JSON.stringify(verifiableCredential));",
							"  });"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{org_1_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"credential\": \n      {\n    \"@context\": [\n      \"https://www.w3.org/2018/credentials/v1\",\n      \"https://w3id.org/traceability/v1\"\n    ],\n    \"id\": \"did:key:z6MkhNsCYEQQWJdyAbfaMZHz4UG6UZoQUGot7z7tBNsbz1JG\",\n    \"type\": [\n      \"VerifiableCredential\",\n      \"CommercialInvoiceCertificate\"\n    ],\n    \"name\": \"Commercial Invoice Certificate\",\n    \"issuanceDate\": \"2022-02-23T11:55:00Z\",\n    \"issuer\": {\n      \"id\": \"{{org_1_holder}}\",\n      \"type\": [\n        \"Organization\"\n      ],\n      \"address\": {\n        \"type\": [\n          \"PostalAddress\"\n        ],\n        \"organizationName\": \"Aishi Metal Shinzo Co., Ltd.\",\n        \"streetAddress\": \"1651, Shimonakano, Yoshida\",\n        \"addressLocality\": \"Tsubame-shi\",\n        \"addressRegion\": \"Niigata-ken\",\n        \"postalCode\": \"959-0215\",\n        \"addressCountry\": \"Japan\"\n      }\n    },\n    \"credentialSubject\": {\n      \"type\": [\n        \"Invoice\"\n      ],\n      \"portOfEntry\": {\n        \"type\": \"Place\",\n        \"unLocode\": \"USLGB\"\n      },\n      \"destinationCountry\": \"MEX\",\n      \"purchaseDate\": \"2021-02-21\",\n      \"seller\": {\n        \"type\": [\n          \"Organization\"\n        ],\n        \"address\": {\n          \"type\": [\n            \"PostalAddress\"\n          ],\n          \"organizationName\": \"Aishi Metal Shinzo Co., Ltd.\",\n          \"streetAddress\": \"1651, Shimonakano, Yoshida\",\n          \"addressLocality\": \"Tsubame-shi\",\n          \"addressRegion\": \"Niigata-ken\",\n          \"postalCode\": \"959-0215\",\n          \"addressCountry\": \"Japan\"\n        }\n      },\n      \"buyer\": {\n        \"type\": [\n          \"Organization\"\n        ],\n        \"address\": {\n          \"type\": [\n            \"PostalAddress\"\n          ],\n          \"organizationName\": \"Generic Motors of America\",\n          \"streetAddress\": \"12 Generic Motors Dr\",\n          \"addressLocality\": \"Detroit\",\n          \"addressRegion\": \"Michigain\",\n          \"postalCode\": \"48232-5170\",\n          \"addressCountry\": \"USA\"\n        }\n      },\n      \"shipToParty\": {\n        \"type\": [\n          \"Organization\"\n        ],\n        \"address\": {\n          \"type\": [\n            \"PostalAddress\"\n          ],\n          \"organizationName\": \"Generic Motors of America\",\n          \"streetAddress\": \"12 Generic Motors Dr\",\n          \"addressLocality\": \"Detroit\",\n          \"addressRegion\": \"Michigain\",\n          \"postalCode\": \"48232-5170\",\n          \"addressCountry\": \"USA\"\n        }\n      },\n      \"itemsShipped\": [\n        {\n          \"type\": \"TradeLineItem\",\n          \"product\": {\n            \"manufacturer\": {\n              \"type\": \"Organization\",\n              \"address\": {\n                \"type\": \"PostalAddress\",\n                \"organizationName\": \"Aishi Metal Shinzo Co., Ltd.\",\n                \"streetAddress\": \"1651, Shimonakano, Yoshida\",\n                \"addressLocality\": \"Tsubame-shi\",\n                \"addressRegion\": \"Niigata-ken\",\n                \"postalCode\": \"959-0215\",\n                \"addressCountry\": \"Japan\"\n              }\n            },\n            \"description\": \"UNS S30400 chromium-nickel stainless steel rolls.\",\n            \"weight\": {\n              \"type\": \"QuantitativeValue\",\n              \"unitCode\": \"lbs\",\n              \"value\": \"16500\"\n            }\n          },\n          \"itemCount\": 5,\n          \"tradeLineItemWeight\": {\n            \"type\": \"QuantitativeValue\",\n            \"value\": \"82500\",\n            \"unitCode\": \"lbs\"\n          },\n          \"priceSpecification\": {\n            \"type\": \"PriceSpecification\",\n            \"price\": 5200,\n            \"priceCurrency\": \"USD\"\n          }\n        },\n        {\n          \"type\": \"TradeLineItem\",\n          \"product\": {\n            \"manufacturer\": {\n              \"type\": \"Organization\",\n              \"address\": {\n                \"type\": \"PostalAddress\",\n                \"organizationName\": \"Aishi Metal Shinzo Co., Ltd.\",\n                \"streetAddress\": \"1651, Shimonakano, Yoshida\",\n                \"addressLocality\": \"Tsubame-shi\",\n                \"addressRegion\": \"Niigata-ken\",\n                \"postalCode\": \"959-0215\",\n                \"addressCountry\": \"Japan\"\n              }\n            },\n            \"description\": \"Galvalannealed ASTM A-653 zinc-iron alloy-coated steel sheets.\",\n            \"weight\": {\n              \"type\": \"QuantitativeValue\",\n              \"value\": \"12680\",\n              \"unitCode\": \"lbs\"\n            }\n          },\n          \"itemCount\": 20,\n          \"tradeLineItemWeight\": {\n            \"type\": \"QuantitativeValue\",\n            \"value\": \"253600\",\n            \"unitCode\": \"lbs\"\n          },\n          \"priceSpecification\": {\n            \"type\": \"PriceSpecification\",\n            \"price\": 4400,\n            \"priceCurrency\": \"USD\"\n          }\n        }\n      ],\n      \"totalWeight\": {\n        \"type\": \"QuantitativeValue\",\n        \"value\": \"336100\",\n        \"unitCode\": \"lbs\"\n      },\n      \"totalPaymentDue\": {\n        \"type\": \"PriceSpecification\",\n        \"price\": 9600,\n        \"priceCurrency\": \"USD\"\n      }\n    }\n  },\n  \"options\": {\n        \"type\": \"Ed25519Signature2018\"\n    }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{ORG_1_BASE_URL}}/credentials/issue",
					"host": [
						"{{ORG_1_BASE_URL}}"
					],
					"path": [
						"credentials",
						"issue"
					]
				}
			},
			"response": []
		},
		{
			"name": "Initiate Exchange",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const responseJson = pm.response.json();",
							"pm.collectionVariables.set(\"org_2_domain\", responseJson.domain);",
							"pm.collectionVariables.set(\"org_2_challenge\", responseJson.challenge);",
							"",
							"pm.test(\"Importer has authenticated to Freight Forwarder\", function () {",
							"    pm.response.to.have.status(200);",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"query\": [\n    {\n      \"type\": \"QueryByExample\",\n      \"credentialQuery\": [\n        {\n          \"type\": [\n            \"VerifiableCredential\"\n          ],\n          \"reason\": \"We want to present credentials.\"\n        }\n      ]\n    }\n  ]\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{org_2_tenant_url}}/presentations/available",
					"host": [
						"{{org_2_tenant_url}}"
					],
					"path": [
						"presentations",
						"available"
					]
				}
			},
			"response": []
		},
		{
			"name": "Sign Presentation",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const {verifiablePresentation} = pm.response.json();",
							"pm.collectionVariables.set(\"importers_presentation_of_ci_to_freight_forwarder\", JSON.stringify(verifiablePresentation));",
							"",
							"pm.test(\"Importer VP of Commercial Invoice with workflow instance 'instance_1' proved\", function () {",
							"    pm.response.to.have.status(201);",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{org_1_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"presentation\": {\n        \"@context\": [\n            \"https://www.w3.org/2018/credentials/v1\",\n            \"https://w3id.org/traceability/v1\"\n        ],\n        \"type\": [\n            \"VerifiablePresentation\",\n            \"TraceablePresentation\"\n        ],\n        \"workflow\": {\n            \"instance\": [\n                \"instance_1\"\n            ],\n            \"definition\": [\n                \"definition_1\"\n            ]\n        },\n        \"holder\": \"{{org_1_holder}}\",\n        \"verifiableCredential\": [\n            {{importers_commercial_invoice_vc}}\n        ]\n    },\n    \"options\": {\n        \"domain\": \"{{org_2_domain}}\",\n        \"challenge\": \"{{org_2_challenge}}\"\n    }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{ORG_1_BASE_URL}}/presentations/prove",
					"host": [
						"{{ORG_1_BASE_URL}}"
					],
					"path": [
						"presentations",
						"prove"
					]
				}
			},
			"response": []
		},
		{
			"name": "Complete Exchange",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"",
							"// The expected response code for a \"Verify Presentation\" request is",
							"// `200 Success`.",
							"pm.test(\"Importer has successfully presented Commercial Invoice to Customs\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"// Response should confirm the presentation is verified.",
							"pm.test(\"Commercial Invoice VP verification returned 'true'\", function() {",
							"    const { verified } = pm.response.json()",
							"    pm.expect(verified).to.be.true;",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{{importers_presentation_of_ci_to_freight_forwarder}}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{org_2_tenant_url}}/presentations/submissions",
					"host": [
						"{{org_2_tenant_url}}"
					],
					"path": [
						"presentations",
						"submissions"
					]
				}
			},
			"response": []
		},
		{
			"name": "Initiate Exchange",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const responseJson = pm.response.json();",
							"pm.collectionVariables.set(\"org_3_domain\", responseJson.domain);",
							"pm.collectionVariables.set(\"org_3_challenge\", responseJson.challenge);",
							"",
							"pm.test(\"Freight Forwarder has authenticated to Customs\", function () {",
							"    pm.response.to.have.status(200);",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"query\": [\n    {\n      \"type\": \"QueryByExample\",\n      \"credentialQuery\": [\n        {\n          \"type\": [\n            \"VerifiableCredential\"\n          ],\n          \"reason\": \"We want to present credentials.\"\n        }\n      ]\n    }\n  ]\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{org_3_tenant_url}}/presentations/available",
					"host": [
						"{{org_3_tenant_url}}"
					],
					"path": [
						"presentations",
						"available"
					]
				}
			},
			"response": []
		},
		{
			"name": "Sign Presentation",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const {verifiablePresentation} = pm.response.json();",
							"pm.collectionVariables.set(\"freight_forwarders_presentation_of_ci_to_customs\", JSON.stringify(verifiablePresentation));",
							"",
							"pm.test(\"Freight Forwarder VP of Commercial Invoice with workflow instances 'instance_1' and 'instance_2' proved\", function () {",
							"    pm.response.to.have.status(201);",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{org_2_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"presentation\": {\n        \"@context\": [\n            \"https://www.w3.org/2018/credentials/v1\",\n            \"https://w3id.org/traceability/v1\"\n        ],\n        \"type\": [\n            \"VerifiablePresentation\",\n            \"TraceablePresentation\"\n        ],\n        \"workflow\": {\n            \"instance\": [\n                \"instance_1\", \n                \"instance_2\"\n            ],\n            \"definition\": [\n                \"definition_1\"\n            ]\n        },\n        \"holder\": \"{{org_2_holder}}\",\n        \"verifiableCredential\": [\n            {{importers_commercial_invoice_vc}}\n        ]\n    },\n    \"options\": {\n        \"domain\": \"{{org_3_domain}}\",\n        \"challenge\": \"{{org_3_challenge}}\"\n    }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{ORG_2_BASE_URL}}/presentations/prove",
					"host": [
						"{{ORG_2_BASE_URL}}"
					],
					"path": [
						"presentations",
						"prove"
					]
				}
			},
			"response": []
		},
		{
			"name": "Complete Exchange",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"",
							"// The expected response code for a \"Verify Presentation\" request is",
							"// `200 Success`.",
							"pm.test(\"Freight Forwarder has successfully presented Commercial Invoice to Customs\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"// Response should confirm the presentation is verified.",
							"pm.test(\"Commercial Invoice VP verification returned 'true'\", function() {",
							"    const { verified } = pm.response.json()",
							"    pm.expect(verified).to.be.true;",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "POST",
				"header": [
					{
						"key": "Accept",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{{freight_forwarders_presentation_of_ci_to_customs}}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{org_3_tenant_url}}/presentations/submissions",
					"host": [
						"{{org_3_tenant_url}}"
					],
					"path": [
						"presentations",
						"submissions"
					]
				}
			},
			"response": []
		},
		{
			"name": "Join Workflow Graphs",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Customs verifies Commercial Invoice\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"var workflowInstances = JSON.parse(pm.collectionVariables.get(\"freight_forwarders_presentation_of_ci_to_customs\")).workflow.instance",
							"",
							"pm.test(\"Customs checks known workflow instance ids and join the workflows\", function () {",
							"    pm.expect(workflowInstances[0]).to.eql(pm.collectionVariables.get(\"customs_first_workflow_instance_id\"));",
							"    pm.expect(workflowInstances[1]).to.eql(pm.collectionVariables.get(\"customs_second_workflow_instance_id\"));",
							"});",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{org_3_access_token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"verifiablePresentation\": {{freight_forwarders_presentation_of_ci_to_customs}},\n    \"options\": {\n        \"domain\": \"{{org_3_domain}}\",\n        \"challenge\": \"{{org_3_challenge}}\"\n    }\n}\n",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{ORG_3_BASE_URL}}/presentations/verify",
					"host": [
						"{{ORG_3_BASE_URL}}"
					],
					"path": [
						"presentations",
						"verify"
					]
				}
			},
			"response": []
		}
	],
	"variable": [
		{
			"key": "org_1_access_token",
			"value": ""
		},
		{
			"key": "org_2_access_token",
			"value": ""
		},
		{
			"key": "org_3_access_token",
			"value": ""
		},
		{
			"key": "org_1_holder",
			"value": ""
		},
		{
			"key": "org_1_tenant_url",
			"value": ""
		},
		{
			"key": "org_2_holder",
			"value": ""
		},
		{
			"key": "org_2_tenant_url",
			"value": ""
		},
		{
			"key": "org_3_holder",
			"value": ""
		},
		{
			"key": "org_3_tenant_url",
			"value": ""
		},
		{
			"key": "importers_proforma_invoice_vc",
			"value": ""
		},
		{
			"key": "org_3_domain",
			"value": ""
		},
		{
			"key": "org_3_challenge",
			"value": ""
		},
		{
			"key": "importers_proforma_invoice_presented_to_customs",
			"value": ""
		},
		{
			"key": "customs_first_workflow_instance_id",
			"value": ""
		},
		{
			"key": "freight_forwarders_hbol_vc",
			"value": ""
		},
		{
			"key": "freight_forwarders_house_bill_presented_to_customs",
			"value": ""
		},
		{
			"key": "customs_second_workflow_instance_id",
			"value": ""
		},
		{
			"key": "importers_commercial_invoice_vc",
			"value": ""
		},
		{
			"key": "org_2_domain",
			"value": ""
		},
		{
			"key": "org_2_challenge",
			"value": ""
		},
		{
			"key": "importers_presentation_of_ci_to_freight_forwarder",
			"value": ""
		},
		{
			"key": "freight_forwarders_presentation_of_ci_to_customs",
			"value": ""
		}
	]
}
